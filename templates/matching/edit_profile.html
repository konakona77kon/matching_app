{% extends "matching/base.html" %}

{% block title %}プロフィールを編集 | melo-match{% endblock %}

{% block extra_css %}
<style>
  .profile-edit-card {
      max-width: 520px;
      margin: 0 auto;
  }
  .profile-edit-form {
      display: flex;
      flex-direction: column;
      gap: 14px;
      margin-top: 16px;
  }
  .form-row {
      display: flex;
      flex-direction: column;
      gap: 4px;
      font-size: 13px;
  }
  .form-row label {
      font-weight: 600;
      color: var(--text-sub);
  }
  .form-row input,
  .form-row textarea,
  .form-row select {
      padding: 8px 10px;
      border-radius: 8px;
      border: 1px solid #ddd;
      font-size: 14px;
      width: 100%;
      box-sizing: border-box;
  }
  .form-row input[type="file"] {
      padding: 4px 0;
      border: none;
  }
  .field-help {
      font-size: 11px;
      color: #999;
  }
  .avatar-preview {
      width: 72px;
      height: 72px;
      border-radius: 50%;
      object-fit: cover;
      border: 2px solid #ffe4ec;
  }
  .form-actions {
      display: flex;
      gap: 12px;
      margin-top: 18px;
      flex-wrap: wrap;
  }
</style>
{% endblock %}

{% block content %}
<div class="card profile-edit-card">
    <div class="page-title">プロフィールを編集</div>

    <div style="font-size:13px; margin-bottom:12px;">
        ログイン中: {{ me.nickname|default:request.user.username }} さん
    </div>

    <form method="post" enctype="multipart/form-data" class="profile-edit-form">
        {% csrf_token %}

        {# ニックネーム #}
        <div class="form-row">
            <label for="id_nickname">ニックネーム</label>
            {{ form.nickname }}
            {{ form.nickname.errors }}
        </div>

        {# 年齢 #}
        <div class="form-row">
            <label for="id_age">年齢</label>
            {{ form.age }}
            {{ form.age.errors }}
        </div>

        {# エリア #}
        <div class="form-row">
            <label for="id_location">エリア</label>
            {{ form.location }}
            {{ form.location.errors }}
        </div>

        {# ひとこと（自己紹介） #}
        <div class="form-row">
            <label for="id_bio">ひとこと</label>
            {{ form.bio }}
            <div class="field-help">簡単な自己紹介を書いてみましょう。</div>
            {{ form.bio.errors }}
        </div>

        {# 目的 #}
        <div class="form-row">
            <label for="id_purpose">利用目的</label>
            {{ form.purpose }}
            {{ form.purpose.errors }}
        </div>

        {# アイコン画像 #}
        <div class="form-row">
            <label>プロフィール画像</label>
            {% if me.avatar %}
                <img src="{{ me.avatar.url }}" alt="現在のアイコン"
                     class="avatar-preview">
            {% else %}
                <div class="field-help">まだ画像が登録されていません。</div>
            {% endif %}
            {{ form.avatar }}
            {{ form.avatar.errors }}
        </div>

        <div class="form-actions">
            <button type="submit" class="btn primary">保存する</button>
            <a href="{% url 'my_profile' %}" class="btn ghost">
                ← 自分のプロフィールに戻る
            </a>
        </div>
    </form>
</div>
{% endblock %}
